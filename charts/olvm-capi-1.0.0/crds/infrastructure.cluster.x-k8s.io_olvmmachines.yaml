---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.16.4
  labels:
    cluster.x-k8s.io/provider: infrastructure-olvm
    cluster.x-k8s.io/v1beta1: v1beta1
  name: olvmmachines.infrastructure.cluster.x-k8s.io
spec:
  group: infrastructure.cluster.x-k8s.io
  names:
    categories:
    - cluster-api
    kind: OLVMMachine
    listKind: OLVMMachineList
    plural: olvmmachines
    shortNames:
    - olvmm
    singular: olvmmachine
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - description: The CAPI OLVMCluster that contains this machine
      jsonPath: .spec.olvmClusterName
      name: Cluster
      type: string
    - description: True if the OLVMCluster is ready
      jsonPath: .status.ready
      name: Ready
      type: string
    - description: The age of the OLVMCluster
      jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    - description: The oVirt Cluster that contains the VM
      jsonPath: .spec.ovirt.ovirtClusterName
      name: OVIRT-Cluster
      priority: 2
      type: string
    - description: The VM memory size
      jsonPath: .spec.ovirt.memory
      name: Memory
      priority: 2
      type: string
    - description: The number of VM CPU cores
      jsonPath: .spec.ovirt.cpu.topology.cores
      name: Cores
      priority: 2
      type: string
    - description: The number of VM CPU sockets
      jsonPath: .spec.ovirt.cpu.topology.sockets
      name: Sockets
      priority: 2
      type: string
    - description: The oVirt VM status
      jsonPath: .status.ovirt.virtualMachine.status
      name: VMStatus
      priority: 2
      type: string
    - description: The oVirt VM IP Address
      jsonPath: .status.ovirt.ipAddress
      name: VMIPAddress
      type: string
    name: v1beta1
    schema:
      openAPIV3Schema:
        description: OLVMMachine specifies am OLVMMachine instance.
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: OLVMMachineSpec defines the specification for a OLVMMachine
              resource.
            properties:
              olvmClusterName:
                description: OLVMClusterName is the CAPI OLVMCluster resource name
                type: string
              olvmVmIpProfileName:
                description: OLVMVmIpProfileName is the OLVM VmIpProfile name specified
                  in the OLVM cluster
                type: string
              ovirt:
                description: OVirtSpecInfo specifies the ovirt info used by the OLVM
                  spec
                properties:
                  cpu:
                    description: Cpu is the vm CPU
                    properties:
                      architecture:
                        description: Architecture specifies the CPU topology.  The
                          default is x86_64/
                        type: string
                      topology:
                        description: Topology specifies the CPU topology.
                        properties:
                          cores:
                            description: Cores specifies the number of CPU cores.  The
                              default is 2.
                            format: int32
                            type: integer
                          sockets:
                            description: Sockets specifies the number of CPU sockets.  The
                              default is 2.
                            format: int32
                            type: integer
                          threads:
                            description: Threads specifies the number of CPU Threads.  The
                              default is 1.
                            format: int32
                            type: integer
                        type: object
                    type: object
                  memory:
                    description: Memory is the memory size of the VM
                    type: string
                  network:
                    description: OVirtNetwork specifies the ovirt network information
                      required to create a VM
                    properties:
                      interfaceType:
                        description: |-
                          InterfaceType is the optional interface.  The default is virtio.
                          See https://www.ovirt.org/documentation/virtual_machine_management_guide/#Virtual_Machine_Network_Interface_dialogue_entries
                        type: string
                      networkName:
                        description: NetworkName is the name of an existing network.
                          Required
                        type: string
                      vnicName:
                        description: VnicName is the name of vm vnic.  Default is
                          nic1
                        type: string
                      vnicProfileName:
                        description: VnicProfileName is the name of an existing vnic
                          profile. Required
                        type: string
                    required:
                    - networkName
                    - vnicProfileName
                    type: object
                  ovirtClusterName:
                    description: OVirtClusterName is the name of the cluster where
                      the VM will be created
                    type: string
                  vmTemplateName:
                    description: VMTemplateName is the name of the template used to
                      create a VM
                    type: string
                required:
                - memory
                - network
                type: object
              providerID:
                description: |-
                  ProviderID is the identifier for the provider’s machine instance.
                  This field is set by the controller
                  ProviderID is expected to match the value set by the KCM cloud provider in the Nodes.
                  The Machine controller bubbles it up to the Machine CR, and it’s used to find the matching Node.
                  Any other consumers can use the providerID as the source of truth to match both Machines and Nodes.
                type: string
            required:
            - olvmClusterName
            - olvmVmIpProfileName
            - ovirt
            type: object
          status:
            description: OLVMMachineStatus defines the status OLVMMachine resource.
            properties:
              addresses:
                description: |-
                  MachineAddress is a list of the host names, external IP addresses, pkg IP addresses,
                  external DNS names, and/or pkg DNS names for the provider’s machine instance
                items:
                  description: MachineAddress is the address of the machine
                  properties:
                    address:
                      type: string
                    type:
                      type: string
                  required:
                  - address
                  - type
                  type: object
                type: array
              conditions:
                description: Conditions are the list of conditions for the OLVMMachine.
                items:
                  description: MachineCondition describes the current condition of
                    the OLVMMachine.
                  properties:
                    lastTransitionTime:
                      description: LastTransitionTime is the last time the condition
                        transitioned from one status to another.
                      type: string
                    message:
                      description: Message is a human-readable message indicating
                        details about the last transition.
                      type: string
                    reason:
                      description: Reason for the condition.  This is a machine-readable
                        one word value.
                      type: string
                    status:
                      description: 'Status of the condition: one of `True`, `False`,
                        or `Unknown`.'
                      type: string
                    type:
                      description: Type of condition.
                      type: string
                  required:
                  - lastTransitionTime
                  - reason
                  - status
                  - type
                  type: object
                type: array
              failureDomains:
                additionalProperties:
                  description: FailureDomainSpec specifies a failuredomain
                  properties:
                    attributes:
                      additionalProperties:
                        type: string
                      description: Attributes are arbitrary attributes for users to
                        apply to a failure domain.
                      type: object
                    controlPlane:
                      description: ControlPlane indicates if failure domain is appropriate
                        for running control plane instances.
                      type: boolean
                  required:
                  - controlPlane
                  type: object
                description: |-
                  FailureDomains is the failure domains that machines should be placed in.
                  The maputil key is the FailureDomain name
                type: object
              failureMessage:
                description: |-
                  FailureMessage indicates there is a fatal problem reconciling the provider’s infrastructure;
                  meant to be a more descriptive value than failureReason
                type: string
              failureReason:
                description: |-
                  FailureReason indicates there is a fatal problem reconciling the provider’s infrastructure;
                  meant to be suitable for programmatic interpretation
                type: string
              lastObservedGeneration:
                description: |-
                  LastObservedGeneration is the latest generation of the OLVMMachine
                  that the controller_foundation has seen, but not necessarily reconciled.
                format: int64
                type: integer
              lastSuccessfulGeneration:
                description: LastSuccessfulGeneration is the last generation of the
                  OLVMMachine that was successfully reconciled.
                format: int64
                type: integer
              ovirt:
                properties:
                  clusterID:
                    type: string
                  clusterName:
                    type: string
                  ipAddress:
                    type: string
                  networkID:
                    type: string
                  networkName:
                    type: string
                  virtualMachine:
                    properties:
                      CreateRequestSuccess:
                        type: boolean
                      creationError:
                        type: string
                      creationStatus:
                        type: string
                      lastGeneration:
                        type: string
                      status:
                        type: string
                      vmID:
                        type: string
                      vmName:
                        type: string
                    required:
                    - CreateRequestSuccess
                    type: object
                  vmTemplateID:
                    type: string
                  vmTemplateName:
                    type: string
                  vnicID:
                    type: string
                  vnicName:
                    type: string
                  vnicProfileID:
                    type: string
                  vnicProfileName:
                    type: string
                required:
                - virtualMachine
                type: object
              ready:
                description: Ready indicates the provider-specific infrastructure
                  has been provisioned and is ready
                type: boolean
            required:
            - ovirt
            - ready
            type: object
        required:
        - spec
        type: object
    served: true
    storage: true
    subresources:
      status: {}
